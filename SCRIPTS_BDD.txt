-- SCRIPTS CREATION DES TABLES
CREATE TABLE T_CATEGORIE(
CATEGORIE VARCHAR(50) NOT NULL,
LIBELLE VARCHAR(50),
);

CREATE TABLE T_MENU(
ID_MENU NUMBER(10) NOT NULL AUTO_INCREMENT,
NOM VARCHAR(50) NOT NULL,
PRIX DECIMAL(10) NOT NULL,
REDUCTION INT,
ENTREE VARCHAR(50) NOT NULL,
PLAT VARCHAR(50) NOT NULL,
DESSERT VARCHAR(50) NOT NULL,
PRIMARY KEY (ID_MENU)
);


CREATE TABLE T_PLAGE(
JOUR DATE NOT NULL,
TIME_DEBUT TIME,
TIME_FIN TIME,
NB_PLACE_DISPO INT,
PRIMARY KEY (JOUR,TIME_DEBUT)
);


CREATE TABLE T_RESTAURANT(
ID_RESTAURANT NUMBER(10) NOT NULL AUTO_INCREMENT,
NOM VARCHAR(50),
ADRESSE VARCHAR(100),
VILLE VARCHAR(50),
NUM_PHONE VARCHAR(20),
EMAIL_VARCHAR(50),
NB_PLACE_MAX INT,
PRIMARY KEY(ID_RESTAURANT)
);

CREATE TABLE T_RESTAURANT_CATEGORIE(
ID_RESTAURANT ID_RESTAURANT NUMBER(10) NOT NULL,
CATEGORIE VARCHAR(50) NOT NULL,
FOREIGN KEY (ID_RESTAURANT) REFERENCES T_RESTAURANT(ID_RESTAURANT),
FOREIGN KEY (CATEGORIE) REFERENCES T_CATEGORIE(CATEGORIE)
);

CREATE TABLE T_RESTAURANT_MENU(
ID_RESTAURANT NUMBER(10) NOT NULL,
ID_MENU NUMBER(10) NOT NULL,
FOREIGN KEY (ID_RESTAURANT) references T_RESTAURANT(ID_RESTAURANT),
FOREIGN KEY (ID_MENU) references ID_MENU(ID_MENU)
);

CREATE TABLE T_ANNONCE(
ID_ANNONCE NUMBER(10) NOT NULL AUTO_INCREMENT,
NUM_PHONE VARCHAR(20),
EMAIL VARCHAR(50),
ID_RESTAURANT NUMBER(10) NOT NULL,
PRIMARY KEY (ID_ANNONCE),
FOREIGN KEY ID_RESTAURANT references T_RESTAURANT(ID_RESTAURANT)
);

CREATE TABLE T_ANNONCE_PLAGE(
JOUR DATE NOT NULL,
TIME_DEBUT TIME NOT NULL,
ID_ANNONCE NUMBER(10) NOT NULL,
FOREIGN KEY (ID_ANNONCE) REFERENCES T_ANNONCE(ID_ANNONCE),
FOREIGN KEY (JOUR,TIME_DEBUT) REFERENCES T_PLAGE(JOUR,TIME_DEBUT));

CREATE TABLE T_USER(
NOM VARCHAR(50) NOT NULL AUTO_INCREMENT,
PRENOM VARCHAR(50) NOT NULL,
MAIL VARCHAR(50) NOT NULL,
PASSWORD VARCHAR(50) NOT NULL,
TELEPHONE VARCHAR(20) NOT NULL,
PROFIL INT,
BONUS INT,
-- 0 CLIENT , 1 RESTAURATEUR
PRIMARY KEY (MAIL)
);

CREATE TABLE T_ANNONCE_USER(
MAIL VARCHAR(50) NOT NULL,
ID_ANNONCE NUMBER(10) NOT NULL,
FOREIGN KEY (ID_ANNONCE) REFERENCES T_ANNONCE(ID_ANNONCE),
FOREIGN KEY (MAIL) REFERENCES T_USER(MAIL)
);




CREATE TABLE T_RESERVATION(
  ID_RESERVATION NUMBER(10) NOT NULL AUTO_INCREMENT,
  ID_ANNONCE NUMBER(10) NOT NULL,
  PRIMARY KEY (ID_RESERVATION),
  FOREIGN KEY (ID_ANNONCE) REFERENCES T_ANNONCE(ID_ANNONCE)
  );


CREATE TABLE T_USER_RESERVATION(
MAIL VARCHAR(50) NOT NULL,
ID_RES NUMBER(10) NOT NULL,
FOREIGN KEY (ID_RES) REFERENCES T_RESERVATION(ID_RESERVATION),
FOREIGN KEY (MAIL) REFERENCES T_USER(MAIL)


);


COMMIT;


-- Jeux de données :
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('GASTRONOMIE','Gastronomie');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('PIZZERIA','Pizzeria');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('BURGER','Burger');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('VEGETARIEN','Végétarien');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('ORIENTAL','Oriental');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('INDIEN','Indien');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('ASIATIQUE','Asiatique');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('JAPONAIS','Japonais');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('COREEN','Coréen');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('PORTUGAIS','Portugais');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('BRESILIEN','Brésilien');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('THAILANDAIS','Thailandais');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('AFRICAIN','Africain');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('MONDE','Cuisine du monde');


COMMIT;
