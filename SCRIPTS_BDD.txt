CREATE TABLE T_CATEGORIE(
CATEGORIE VARCHAR(50) NOT NULL,
LIBELLE VARCHAR(50),
PRIMARY KEY (CATEGORIE)
);

CREATE SEQUENCE SQ_ID_MENU START 1;

CREATE TABLE T_MENU(
ID_MENU INTEGER NOT NULL ,
NOM VARCHAR(50) NOT NULL,
PRIX DECIMAL(10) NOT NULL,
REDUCTION INT,
ENTREE VARCHAR(250) NOT NULL,
PLAT VARCHAR(250) NOT NULL,
DESSERT VARCHAR(250) NOT NULL,
PRIMARY KEY (ID_MENU)
);



CREATE TABLE T_PLAGE(
JOUR DATE NOT NULL,
TIME_DEBUT TIME,
TIME_FIN TIME,
NB_PLACE_DISPO INT,
PRIMARY KEY (JOUR,TIME_DEBUT)
);

CREATE SEQUENCE SQ_ID_RESTAURANT START 1;

CREATE TABLE T_RESTAURANT(
ID_RESTAURANT INTEGER NOT NULL,
NOM VARCHAR(50) NOT NULL,
ADRESSE VARCHAR(100),
VILLE VARCHAR(50) ,
NUM_PHONE VARCHAR(50),
EMAIL VARCHAR(50),
NB_PLACE_MAX INT ,
TIME_OUVERTURE TIME,
TIME_FERMETURE TIME,
CATEGORIE VARCHAR(50),
PHOTO BYTEA,
PRIMARY KEY(ID_RESTAURANT),
FOREIGN KEY (CATEGORIE) REFERENCES T_CATEGORIE(CATEGORIE)
);


CREATE TABLE T_RESTAURANT_MENU(
ID_RESTAURANT INTEGER NOT NULL,
ID_MENU INTEGER NOT NULL,
FOREIGN KEY (ID_RESTAURANT) references T_RESTAURANT(ID_RESTAURANT),
FOREIGN KEY (ID_MENU) references T_MENU(ID_MENU)
);


CREATE SEQUENCE SQ_ID_ANNONCE START 1;

CREATE TABLE T_ANNONCE(
ID_ANNONCE INTEGER NOT NULL,
NUM_PHONE VARCHAR(20),
EMAIL VARCHAR(50),
ID_RESTAURANT INTEGER references T_RESTAURANT(ID_RESTAURANT),
PRIMARY KEY (ID_ANNONCE)

);


CREATE TABLE T_ANNONCE_PLAGE(
JOUR DATE NOT NULL,
TIME_DEBUT TIME NOT NULL,
ID_ANNONCE INTEGER NOT NULL,
FOREIGN KEY (ID_ANNONCE) REFERENCES T_ANNONCE(ID_ANNONCE),
FOREIGN KEY (JOUR,TIME_DEBUT) REFERENCES T_PLAGE(JOUR,TIME_DEBUT)
);


CREATE TABLE T_USER(
NOM VARCHAR(50) NOT NULL,
PRENOM VARCHAR(50) NOT NULL,
MAIL VARCHAR(50) NOT NULL,
PASSWORD VARCHAR(50) NOT NULL,
TELEPHONE VARCHAR(20) NOT NULL,
PROFIL INT,
BONUS INT,
-- 0 CLIENT , 1 RESTAURATEUR
PRIMARY KEY (MAIL)
);

CREATE TABLE T_USER_RESTAURANT(
MAIL VARCHAR(50) NOT NULL,
ID_RESTAURANT INTEGER NOT NULL,
FOREIGN KEY (ID_RESTAURANT) REFERENCES T_RESTAURANT(ID_RESTAURANT),
FOREIGN KEY (MAIL) REFERENCES T_USER(MAIL)
);


CREATE SEQUENCE SQ_ID_RESERVATION START 1;
CREATE TABLE T_RESERVATION(
ID_RESERVATION INTEGER NOT NULL,
ID_ANNONCE INTEGER REFERENCES T_ANNONCE(ID_ANNONCE),
PRIMARY KEY (ID_RESERVATION)
);

CREATE TABLE T_USER_RESERVATION(
MAIL VARCHAR(50) NOT NULL,
ID_RES INTEGER NOT NULL,
FOREIGN KEY (ID_RES) REFERENCES T_RESERVATION(ID_RESERVATION),
FOREIGN KEY (MAIL) REFERENCES T_USER(MAIL)
);



COMMIT;





-- Jeux de données :
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('ORIENTAL','Oriental');

INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('GASTRONOMIE','Gastronomie');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('PIZZERIA','Pizzeria Italienne');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('BURGER','Burger');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('VEGETARIEN','Végétarien');

INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('INDIEN','Indien');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('ASIATIQUE','Asiatique');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('JAPONAIS','Japonais');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('PORTUGAIS','Portugais');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('AFRICAIN','Africain');
INSERT INTO T_CATEGORIE(CATEGORIE,LIBELLE) VALUES('MONDE','Cuisine du monde');

-- INSERTION DES USERS

INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('YAHIA-CHERIF','Linda','linda.yahia.cherif@gmail.com','password','0102',1,100);
INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('BAICHE','Mourad','baiche.mourad@gmail.com','password','0102',0,0);
INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('AHAMADA','Hakim','hakim.Ahamada@gmail.com','password','0102',1,100);
INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('BAQA','Bahaa','bahaa.baqa@gmail.com','password','0102',1,100);
INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('CRISTIANO','Ronaldo','ronaldo.cr7@gmail.com','password','07',1,100);
INSERT INTO T_USER(NOM,PRENOM,MAIL,PASSWORD,TELEPHONE,PROFIL,BONUS) VALUES('JEAN','Mouloud','jean.mouloud@gmail.com','password','0105',0,0);


-- Restaurant le Tipaza 155, rue Saint Charles 75015 Paris France
INSERT INTO T_MENU(ID_MENU,NOM,PRIX,REDUCTION,ENTREE,PLAT,DESSERT) VALUES (NEXTVAL('SQ_ID_MENU'),'Menu Délice Oriental','22','20','Salade Berbère à l œuf et merguez ou Chakcouka à l œuf et merguez  ou Brick à l oeuf et viande hachée ',
'Tajine Dolma aux fruits secs flambés à l alcool de figues (boulette d agneau et bœuf maison, figues, dattes et oignons confits) ou Couscous Royal (méchoui, brochette de gigot d agneau, merguez maison, boulette) ou Alouch Moslih',
'Tarte Berbère (croustillant de pâte feuilletée, pommes, raisins secs, cannelle) ou Coupe Tipaza (glace vanille, noisette, chantilly, sauce noisette) ou Coupe Berbère (glace noisette, dattes, figues, sauce caramel)');

-- Restaurant Molto Gusto 
INSERT INTO T_MENU(ID_MENU,NOM,PRIX,REDUCTION,ENTREE,PLAT,DESSERT) VALUES (NEXTVAL('SQ_ID_MENU'),'Bombino','8.5','0','','Nugget Frittes ou Spaghetti bolognaise','2 boules de glaces et un jus de fruits');
INSERT INTO T_MENU(ID_MENU,NOM,PRIX,REDUCTION,ENTREE,PLAT,DESSERT) VALUES (NEXTVAL('SQ_ID_MENU'),'Menu Gourmand','25','0','Salade niçoise ou  Escargots ou Tartate avocat crevette','Pizza a base de crème fraiche ou à base de tomates au choix','Fondue au Chocolat ou Tarte au citron');

--Sushirama
INSERT INTO T_MENU(ID_MENU,NOM,PRIX,REDUCTION,ENTREE,PLAT,DESSERT) VALUES (NEXTVAL('SQ_ID_MENU'),'Le Yoshida gourmand','16','10','Mango yuzu : saumon mariné à la mangue, avocat, sauce yuzu',
'Roll rama (10P) tempura crevette, avocat, concombre, sauce mayo, épicé',
'Demi mangue fraîche ou Glace au thé vert ou Gâteau dorayaki haricot rouge, thé vert');

-- Les enfants teribles
INSERT INTO T_MENU(ID_MENU,NOM,PRIX,REDUCTION,ENTREE,PLAT,DESSERT) VALUES (NEXTVAL('SQ_ID_MENU'),'Le Grand Gourmand','32','0','Foie gras de canard maison: cuit en terrine, chutney d oignons aux fruits rouges (Petite ou Grande )',
'Filet de boeuf, beurre maître d hôtel au noix','Le macaron framboise et sa mousseline de litchi ou Terrible : glace vanille, cookies, chantilly ou Le mi-cuit au chocolat noir, boule vanille');

